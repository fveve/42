# Main server block
server {
    # SSL/TLS Configuration
    listen 443 ssl;  # SSL specified directly on listen (no `ssl on` directive)
    
    ssl_protocols TLSv1.2 TLSv1.3;  # Only allow secure protocols
    ssl_certificate /etc/nginx/ssl/inception.crt;  # Path to SSL certificate
    ssl_certificate_key /etc/nginx/ssl/inception.key;  # Path to SSL key

    # Root directory and default file indexes
    root /var/www/html;  # Set root directory for WordPress
    server_name arafa.42.fr;  # Replace with IP or domain (e.g., login.42.fr)
    index index.php index.html index.htm;  # Specify default files to serve

    # Location block for handling unknown requests with a 404 error
    location / {
        try_files $uri $uri/ =404;  # Return 404 if the file or directory is not found
    }

    # PHP processing block (for proxying PHP requests to WordPress container)
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;  # Load FastCGI settings
        fastcgi_pass wordpress:9000;  # Forward PHP requests to WordPress container on port 9000
    }

    # Additional security headers (optional but recommended)
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options SAMEORIGIN;
    add_header X-XSS-Protection "1; mode=block";
}
